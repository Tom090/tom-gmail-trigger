"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.startServer = void 0;
const express = require("express");
const cors = require("cors");
const startServer = (controllers, options) => {
    const port = options.port ?? 3000;
    const app = express();
    const router = express.Router();
    app.use(cors());
    const newRouter = controllers.map((controller) => controller.addRoutes(router));
    app.disable('etag');
    app.disable('x-powered-by');
    const skipBodyParserForMultipartFormData = (req) => {
        const contentType = req.headers['content-type'];
        return !(contentType && contentType.startsWith('multipart/form-data'));
    };
    app.use(express.raw({
        limit: '50mb',
        type: (req) => skipBodyParserForMultipartFormData(req),
    }));
    app.use('/', newRouter);
    return app.listen(port, () => {
        console.log(`Web server listening on port ${port}`);
    });
};
exports.startServer = startServer;
